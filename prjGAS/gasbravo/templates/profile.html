{% extends 'layouts/base.html' %} {% block title %} Usuario {% endblock title %}

<!-- Specific CSS goes HERE -->
{% block stylesheets %}{% endblock stylesheets %} {% block content %}

<div class="container-fluid">
    <div class="page-header min-height-150 border-radius-xl mt-4" style="background-image: url('/static/assets/img/curved-images/curved14.jpg'); background-position-y: 15%;">
        <span class="mask bg-gradient-info opacity-5"></span>
    </div>
    <div class="card card-body blur shadow-blur mx-4 mt-n6">
        <div class="row gx-4">
            <div class="col-auto">
                <div class="avatar avatar-xl position-relative">
                    {% if logged_user.gender == 1 %}
                    <img src="/static/assets/img/hombre.png" alt="avatar.png" class="w-100 border-radius-lg shadow-sm"> {% else %}
                    <img src="/static/assets/img/mujer.png" alt="avatar.png" class="w-100 border-radius-lg shadow-sm"> {% endif %}

                </div>
            </div>
            <div class="col-auto my-auto">
                <div class="h-100">
                    <h5 class="mb-1">
                        {{logged_user.first_name}} {{logged_user.last_name}}
                    </h5>
                    <p class="mb-0 font-weight-bold text-sm">
                        {{logged_user.dni}}
                    </p>
                </div>
            </div>
            <div class="col-sm-1 col-4 my-sm-auto ms-sm-auto me-sm-0 mx-auto mt-3">
                <div class="nav-wrapper position-relative end-0">
                    <ul class="nav nav-pills nav-fill p-1 bg-transparent">
                        <li class="nav-item">
                            <a class="nav-link mb-0 px-0 py-1 active " href="/app/user_profile/edit" aria-controls="dashborad" aria-selected="true">
                                <i class="fas fa-user-edit"></i>
                                <span class="ms-1">Editar</span>
                            </a>
                        </li>

                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="container-fluid py-4">

    <div class="row my-3">

        <div class="col-12 col-xl-3">
            <div class="card mb-4">
                <div class="card-header pb-0 p-3">
                    <div class="row">
                        <div class="col-md-8 d-flex align-items-center">
                            <h6 class="mb-0">Información de mi perfil</h6>
                        </div>

                    </div>
                </div>
                <div class="card-body p-3">

                    <hr class="horizontal gray-light my-1">
                    <ul class="list-group">
                        <li class="list-group-item border-0 ps-0  pt-0 text-sm"><strong class="text-dark">Identificación: </strong> &nbsp; {{logged_user.dni}}</li>
                        <li class="list-group-item border-0 ps-0  text-sm"><strong class="text-dark">Nombre: </strong> &nbsp; {{logged_user.first_name}} {{logged_user.last_name}}</li>
                        <li class="list-group-item border-0 ps-0 text-sm"><strong class="text-dark">Edad:</strong> &nbsp; {{logged_user.age}} años</li>
                        {% if logged_user.gender == 2 %}
                        <li class="list-group-item border-0 ps-0 text-sm"><strong class="text-dark">Sexo:</strong> &nbsp;FEMENINO </li>
                        {% else %}
                        <li class="list-group-item border-0 ps-0 text-sm"><strong class="text-dark">Sexo:</strong> &nbsp;MASCULINO </li>
                        {% endif %}
                        <li class="list-group-item border-0 ps-0 text-sm"><strong class="text-dark">Email:</strong> &nbsp; {{logged_user.email}}</li>
                        <li class="list-group-item border-0 ps-0 text-sm"><strong class="text-dark">Fecha registro:</strong> &nbsp;{{logged_user.created_at}}</li>

                    </ul>
                </div>
            </div>
        </div>
        <div class="col-12 col-xl-4">
            <div class="card mb-4">
                <div class="card-header pb-0 p-3">
                    <h6 class="mb-0">Dosis Administradas</h6>
                </div>
                <div class="card-body p-3">
                    <hr class="horizontal gray-light my-1">
                    <h6 class="text-uppercase text-body text-sm font-weight-bolder mt-3"> PRIMERA DOSIS</h6>
                    {% if user_first_dose %} {% for first_dose in user_first_dose %}
                    <ul class="list-group">

                        <li class="list-group-item border-0 ps-0   text-sm"><strong class="text-dark">Vacuna:</strong> &nbsp; {{first_dose.vaccine.name}} ({{first_dose.vaccine.description}})</li>
                        <li class="list-group-item border-0 ps-0  text-sm"><strong class="text-dark">Centro Vacunación:</strong> &nbsp; {{first_dose.vaccination_center.place}}</li>
                        <li class="list-group-item border-0 ps-0  text-sm"><strong class="text-dark">Fecha Vacunación:</strong> &nbsp; {{first_dose.date}} </li>
                        <li class="list-group-item border-0 ps-0 text-sm"><strong class="text-dark">Vacunador:</strong> &nbsp; {{first_dose.vaccinator_name}}</li>
                        <li class="list-group-item border-0 ps-0 text-sm"><strong class="text-dark">Lote Vacuna:</strong> &nbsp; {{first_dose.vaccine_lot}}</li>
                        {% if first_dose.covid == 1%}
                        <li class="list-group-item border-0 ps-0 text-sm"><strong class="text-dark">Contagio Post Dosis:</strong> &nbsp; <strong>SI</strong></li>
                        {% else %}
                        <li class="list-group-item border-0 ps-0 text-sm"><strong class="text-dark">Contagio Post Dosis:</strong> &nbsp; NO</li>
                        {% endif %}
                        <li class="list-group-item border-0 ps-0 text-sm"><strong class="text-dark">Fecha registro:</strong> &nbsp;{{first_dose.created_at}}</li>
                    </ul>

                    <div class="ms-auto">
                        {% if not user_second_dose %}
                        <a class="btn btn-link text-danger text-gradient px-3 mb-0" href="/app/vaccination/{{first_dose.id}}/destroy"><i class="far fa-trash-alt me-2"></i>Eliminar</a>
                        <a class="btn btn-link text-info  px-3 mb-0" href="/app/vaccination/{{first_dose.id}}/feedback"><i class="far fa-comment-alt me-2"> <strong>Agregar Feedback</strong></i></a> {% if this_user_covid == False%}
                        <a class="btn btn-link text-success  px-3 mb-0" href="/app/vaccination/{{first_dose.id}}/report_covid"><i class="fas fa-virus"></i><strong>Reportar Contagio</strong></i></a> {% endif %} {% endif %}
                    </div>
                    {% endfor %} {% else %}

                    <div class="ms-auto">
                        <p>Usuario no registra primera dosis</p>
                        <a class="btn btn-link text-info text-gradient px-3 mb-0" href="/app/vaccination/1"><i class="far fa-plus-square me-2"></i>Agregar</a>
                    </div>
                    {% endif %}

                    <!-- Segunda Dosis -->
                    <h6 class="text-uppercase text-body text-sm  font-weight-bolder mt-4">SEGUNDA DOSIS</h6>
                    {% if user_first_dose %} {% if user_second_dose %} {% for second_dose in user_second_dose %}
                    <ul class="list-group">

                        <li class="list-group-item border-0 ps-0   text-sm"><strong class="text-dark">Vacuna:</strong> &nbsp; {{second_dose.vaccine.name}} ({{second_dose.vaccine.description}})</li>
                        <li class="list-group-item border-0 ps-0  text-sm"><strong class="text-dark">Centro Vacunación:</strong> &nbsp; {{second_dose.vaccination_center.place}}</li>
                        <li class="list-group-item border-0 ps-0  text-sm"><strong class="text-dark">Fecha:</strong> &nbsp; {{second_dose.date}} </li>
                        <li class="list-group-item border-0 ps-0 text-sm"><strong class="text-dark">Vacunador:</strong> &nbsp; {{second_dose.vaccinator_name}}</li>
                        <li class="list-group-item border-0 ps-0 text-sm"><strong class="text-dark">Lote Vacuna:</strong> &nbsp; {{second_dose.vaccine_lot}}</li>
                        {% if second_dose.covid == 1%}
                        <li class="list-group-item border-0 ps-0 text-sm"><strong class="text-dark">Contagio Post Dosis:</strong> &nbsp; <strong>SI</strong></li>
                        {% else %}
                        <li class="list-group-item border-0 ps-0 text-sm"><strong class="text-dark">Contagio Post Dosis:</strong> &nbsp; NO</li>
                        {% endif %}
                        <li class="list-group-item border-0 ps-0 text-sm"><strong class="text-dark">Fecha registro:</strong> &nbsp;{{second_dose.created_at}}</li>
                    </ul>

                    <div class="ms-auto">

                        <a class="btn btn-link text-danger text-gradient px-3 mb-0" href="/app/vaccination/{{second_dose.id}}/destroy"><i class="far fa-trash-alt me-2"></i>Eliminar</a>
                        <a class="btn btn-link text-info px-3 mb-0" href="/app/vaccination/{{second_dose.id}}/feedback"><i class="far fa-comment-alt me-2"> <strong> Agregar Feedback</strong> </i></a> {% if this_user_covid == False %}
                        <a class="btn btn-link text-success  px-3 mb-0" href="/app/vaccination/{{second_dose.id}}/report_covid"><i class="fas fa-virus"></i><strong>Reportar Contagio</strong></i></a> {% endif %}
                    </div>
                    {% endfor %} {% else %}
                    <div class="ms-auto">
                        <p>Usuario no registra segunda dosis</p>
                        <a class="btn btn-link text-info text-gradient px-3 mb-0" href="/app/vaccination/2"><i class="far fa-plus-square me-2"></i>Agregar</a>

                    </div>
                    {% endif %} {% else %}
                    <p>Usuario no registra segunda dosis</p>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="col-12 col-xl-5">
            <div class="card mb-4">
                <div class="card-header pb-0 p-3">
                    <h6 class="mb-0">Últimos Feedbacks</h6>
                </div>
                <div class="card-body p-3">
                    <ul class="list-group">

                        <div class="card-body pt-2 p-3">
                            {% if feedbacks %}
                            <ul class="list-group">
                                {% for feedback in feedbacks%}
                                <li class="list-group-item border-0 d-flex p-4 mb-2 bg-gray-100 border-radius-lg">
                                    <div class="d-flex flex-column">
                                        <h6 class="mb-3 text-info text-sm">{{feedback.date}}</h6>
                                        <span class="mb-2 text-xs">Dosis: <span class="text-dark font-weight-bold ms-2">{% if feedback.vaccination.dose == 1%}Primera Dosis {% else %} Segunda Dosis {% endif %} </span></span>
                                        <span class="mb-2 text-xs">Efectos Adversos: <span class="text-dark ms-2 font-weight-bold">{{feedback.side_effect.name}}</span></span>
                                        <span class="mb-2 text-xs">Alergias: <span class="text-dark ms-2 font-weight-bold">{{feedback.allergy.name}}</span></span>
                                        <span class="text-xs">Comentarios: <span class="text-dark ms-2 font-weight-bold">{{feedback.feedback}}</span></span>
                                    </div>
                                    <div class="ms-auto">
                                        <a class="btn btn-link text-danger text-gradient px-3 mb-0" href="/app/feedback/{{feedback.id}}/delete"><i class="far fa-trash-alt me-2"></i>Eliminar</a>

                                    </div>
                                </li>
                                {% endfor %}

                            </ul>
                            {% else %}
                            <p>Todavía no has ingresado ningún feedback</p>
                            {% endif %}
                        </div>

                    </ul>
                </div>
            </div>
        </div>

    </div>

    {% include "includes/footer.html" %}

</div>

{% endblock content %}

<!-- Specific JS goes HERE -->
{% block javascripts %}

<script>
    var win = navigator.platform.indexOf('Win') > -1;
    if (win && document.querySelector('#sidenav-scrollbar')) {
        var options = {
            damping: '0.5'
        }
        Scrollbar.init(document.querySelector('#sidenav-scrollbar'), options);
    }
</script>

{% endblock javascripts %}